import Code from '../../../components/Code.jsx';

# Construção de Backend

## NodeJS

### Arquitetura

![](/imgs/node-http/client-server.png)

### HTTP Module

app.js:

<Code src="/codes/node-http/hello-simple/app.js" lang="js" />

```
$ node app.js
```

![](/imgs/node-http/hello-http.png)

### HTTP Request

Visual Studio Code: [REST Client](https://marketplace.visualstudio.com/items?itemName=humao.rest-client)

requests.http:

<Code src="/codes/node-http/hello-simple/requests.http" lang="txt" />

```txt
HTTP/1.1 200 OK
Content-Type: text/plain
Date: Thu, 03 Sep 2020 22:19:08 GMT
Connection: close
Content-Length: 11

Hello World
```

## Express

### Definição

[Site Express](http://expressjs.com/):

> Express is a minimal and flexible Node.js web application framework that provides a robust set of features for web and mobile applications.

### Características

- Rápido
- Minimalista
- Flexível
- Não opinativo
- Usado para montar APIs
- Alguns frameworks são baseados no Express

### Estrutura do projeto

```text
hello-simple
├── .gitignore
├── package-lock.json
├── package.json
├── requests.http
└── src
    └── index.js
```

![](/imgs/express/hello-simple-flow.png)

hello-simple/src/index.js:

<Code src="/codes/express/hello-simple/src/index.js" lang="js" />

Criar o arquivo `package.json`:

```sh
$ npm init -y
```

Adicionar o Express como dependência do projeto e executar o servidor localmente:

```sh
$ npm install express
$ node src/index.js
$ npm start
```

Adicionar o nodemon como dependência de desenvolvimento e executar o servidor enquanto desenvolve:

```sh
$ npm install nodemon -D
$ npx nodemon src/index.js
$ npm run dev
```

hello-simple/package.json:

<Code src="/codes/express/hello-simple/package.json" lang="json" />

> Cuidado no git para não versionar a pasta `node_modules/`, use o arquivo `.gitignore` para desconsiderar a pasta.

hello-simple/.gitignore:

```text
node_modules
```

hello-simple/requests.http:

<Code src="/codes/express/hello-simple/requests.http" lang="text" />

![](/imgs/express/hello-simple-response.png)

[![Edit express-hello-simple](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/express-hello-simple-w0gy4?fontsize=14&hidenavigation=1&theme=dark)

## Rotas da Aplicação

Rotas:

- `/hello/en` => `Hello World!`
- `/hello/pt` => `Olá Mundo!`

![](/imgs/express/hello-lang.png)

```text
hello-lang
├── .gitignore
├── package-lock.json
├── package.json
├── requests.http
└── src
    └── index.js
```

hello-lang/src/index.js:

<Code src="/codes/express/hello-lang/src/index.js" lang="js" />

hello-lang/package.json:

<Code src="/codes/express/hello-lang/package.json" lang="json" />

hello-lang/requests.http:

<Code src="/codes/express/hello-lang/requests.http" lang="text" />

[![Edit express-hello-lang](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/express-hello-lang-wnqe3?fontsize=14&hidenavigation=1&theme=dark)

## Parâmetros da Requisição

### Tipos de Parâmetros

![](/imgs/express/client-server-param.png)

Parâmetros:

- Query Param
- Route Param
- Body Param

### Query Param

![](/imgs/express/bmi-query-param.png)

```text
bmi-query-param
├── .gitignore
├── package-lock.json
├── package.json
├── requests.http
└── src
    ├── bmi.js
    └── index.js
```

bmi-query-param/src/bmi.js:

<Code src="/codes/express/bmi-query-param/src/bmi.js" lang="js" />

bmi-query-param/src/index.js:

<Code src="/codes/express/bmi-query-param/src/index.js" lang="js" />

bmi-query-param/package.json:

<Code src="/codes/express/bmi-query-param/package.json" lang="json" />

bmi-query-param/requests.http:

<Code src="/codes/express/bmi-query-param/requests.http" lang="text" />

[![Edit express-bmi-query-param](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/express-bmi-query-param-2200f?fontsize=14&hidenavigation=1&theme=dark)

### Route Param

![](/imgs/express/bmi-route-param.png)

```text
bmi-route-param
├── .gitignore
├── package-lock.json
├── package.json
├── requests.http
└── src
    ├── bmi.js
    └── index.js
```

bmi-route-param/src/index.js:

<Code src="/codes/express/bmi-route-param/src/index.js" lang="js" />

bmi-route-param/requests.http:

<Code src="/codes/express/bmi-route-param/requests.http" lang="text" />

[![Edit express-bmi-route-param](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/express-bmi-route-param-stu6s?fontsize=14&hidenavigation=1&theme=dark)

### Body Param

![](/imgs/express/bmi-body-param.png)

```text
bmi-body-param
├── .gitignore
├── package-lock.json
├── package.json
├── requests.http
└── src
    ├── bmi.js
    └── index.js
```

bmi-body-param/src/index.js:

<Code src="/codes/express/bmi-body-param/src/index.js" lang="js" />

bmi-body-param/requests.http:

<Code src="/codes/express/bmi-body-param/requests.http" lang="text" />

[![Edit express-bmi-body-param](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/express-bmi-body-param-gh2hg?fontsize=14&hidenavigation=1&theme=dark)

[REQBIN](https://reqbin.com/wijfzyzb)

### Resumo das Rotas

| Tipo        | Acesso       | HTTP | Rota                                 | Dados                              |
| ----------- | ------------ | ---- | ------------------------------------ | ---------------------------------- |
| Query Param | `req.query`  | GET  | `/bmi?weight=x&height=y`             | `?weight=100&height=1.5`           |
| Route Param | `req.params` | GET  | `/bmi/weight/:weight/height/:height` | `/bmi/weight/100/height/1.5`       |
| Body Param  | `req.body`   | POST | `/bmi`                               | `{ "weight": 100, "height": 1.5 }` |

## Referências

- [Express](https://expressjs.com/)
  - [Guide](https://expressjs.com/en/guide/routing.html)
  - [API](https://expressjs.com/en/4x/api.html)
